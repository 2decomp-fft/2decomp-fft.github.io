
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Installation &#8212; 2decomp_doc  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Domain Decomposition Strategies" href="domaindecomposition.html" />
    <link rel="prev" title="Welcome to the documentation for the 2DECOMP&amp;FFT library!" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>The build system is driven by <code class="docutils literal notranslate"><span class="pre">cmake</span></code>. It is good practice to directly point to the MPI Fortran wrapper
that you would like to use to guarantee consistency between Fortran compiler and MPI.
This can be done by setting the default Fortran environmental variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">FC</span><span class="o">=</span><span class="n">my_mpif90</span>
</pre></div>
</div>
<p>To generate the build system run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake -S $path_to_sources -B $path_to_build_directory -DOPTION1 -DOPTION2 ...
</pre></div>
</div>
<p>If the directory does not exist it will be generated and it will contain the configuration files.
The configuration can be further edited by using the <code class="docutils literal notranslate"><span class="pre">ccmake</span></code> utility as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ccmake $path_to_build_directory
</pre></div>
</div>
<p>and editing as desired, variables that are likely of interest are: <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> and <code class="docutils literal notranslate"><span class="pre">FFT_Choice</span></code>;
additional variables can be shown by entering <cite>advanced mode</cite> by pressing <cite>t</cite>.</p>
<p>By default a <code class="docutils literal notranslate"><span class="pre">RELEASE</span></code> build will built, other options for <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> are <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> and <cite>DEV</cite>
which turn on debugging flags and additionally try to catch coding errors at compile time, respectively.</p>
<p>The behaviour of debug and development versions of the library can be changed before the
initialization using the variable <code class="docutils literal notranslate"><span class="pre">decomp_debug</span></code> or the environment variable <code class="docutils literal notranslate"><span class="pre">DECOMP_2D_DEBUG</span></code>.
The value provided with the environment variable must be a positive integer below 9999.</p>
<p>Two <code class="docutils literal notranslate"><span class="pre">BUILD_TARGETS</span></code> are available namely <code class="docutils literal notranslate"><span class="pre">mpi</span></code> and <code class="docutils literal notranslate"><span class="pre">gpu</span></code>.
For the <code class="docutils literal notranslate"><span class="pre">mpi</span></code> target no additional options should be required,
whereas for <code class="docutils literal notranslate"><span class="pre">gpu</span></code> extra options are necessary at the configure stage.
Please see <a class="reference internal" href="#labelgpu"><span class="std std-ref">GPU compilation</span></a> section.</p>
<p>Once the build system has been configured, you can build 2DECOMP&amp;FFT by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake --build $path_to_build_directory -j &lt;nproc&gt;
</pre></div>
</div>
<p>appending <code class="docutils literal notranslate"><span class="pre">-v</span></code> will display additional information about the build, such as compiler flags.</p>
<p>After building the library can be tested using <code class="docutils literal notranslate"><span class="pre">ctest</span></code>. Please see <a class="reference internal" href="#labeltest"><span class="std std-ref">Testing and examples</span></a> section</p>
<p>Options can be added to change the level of verbosity.
Finally, the build library can be installed by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake --install $path_to_build_directory
</pre></div>
</div>
<p>The default location for <strong>libdecomp2d.a</strong> is</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$path_to_build_directory/opt/lib</span></code> or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$path_to_build_directory/opt/lib64</span></code></p></li>
</ul>
<p>unless the variable <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> is modified.</p>
<p>The module files generated by the build process will similarly be installed to
<code class="docutils literal notranslate"><span class="pre">$path_to_build_directory/opt/install</span></code>,
users of the library should add this to the include paths for their program.</p>
<p>As indicated above, by default a static <strong>libdecomp2d.a</strong> will be compiled,
if desired a shared library can be built by setting <code class="docutils literal notranslate"><span class="pre">BUILD_SHARED_LIBS=ON</span></code> either on the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake -S $path_to_sources -B $path_to_build_directory -DBUILD_SHARED_LIBS=ON
</pre></div>
</div>
<p>or by editing the configuration using <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>.</p>
<p>This might be useful for a centralised install supporting multiple users that is upgraded over time.</p>
<p>Occasionally a clean build is required, this can be performed by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake --build $path_to_build_directory --target clean
</pre></div>
</div>
</div>
<div class="section" id="testing-and-examples">
<span id="labeltest"></span><h2>Testing and examples<a class="headerlink" href="#testing-and-examples" title="Permalink to this headline">¶</a></h2>
<p>By default building of the tests is deactivated.
To activate the testing the option <code class="docutils literal notranslate"><span class="pre">-DBUILD_TESTING=ON</span></code> can be added or
alternativey the option can be activated in the GUI interface <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>.
After building the library can be tested by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ctest --test-dir $path_to_build_directory
</pre></div>
</div>
<p>which uses the <code class="docutils literal notranslate"><span class="pre">ctest</span></code> utility. By default tests are performed in serial,
but more than 1 rank can be used by setting <code class="docutils literal notranslate"><span class="pre">MPIEXEC_MAX_NUMPROCS</span></code> under <code class="docutils literal notranslate"><span class="pre">ccmake</span></code> utility.
It is also possible to specify the decomposition by setting
<code class="docutils literal notranslate"><span class="pre">prow</span></code> and <code class="docutils literal notranslate"><span class="pre">pcol</span></code> parameters at the configure stage or using <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>.
During the configure stage users should ensure that the number of MPI tasks <code class="docutils literal notranslate"><span class="pre">MPIEXEC_MAX_NUMPROCS</span></code>
is equal to the product of <em>pcol</em> times <em>prow</em>.
Mesh resolution can also be imposed using the parameters <code class="docutils literal notranslate"><span class="pre">NX</span></code>, <code class="docutils literal notranslate"><span class="pre">NY</span></code> and <code class="docutils literal notranslate"><span class="pre">NZ</span></code>.</p>
<p>For the GPU implementation please be aware that it is based on a single MPI rank per GPU.
Therefore, to test multiple GPUs, use the maximum number of available GPUs
on the system/node and not the maximum number of MPI tasks.</p>
</div>
<div class="section" id="gpu-compilation">
<span id="labelgpu"></span><h2>GPU compilation<a class="headerlink" href="#gpu-compilation" title="Permalink to this headline">¶</a></h2>
<p>The library can perform multi GPU offoloading using the NVHPC compiler suite for NVIDIA hardware.
The implementation is based on CUDA-aware MPI and NVIDIA Collective Communication Library (NCCL).
The FFT is based on cuFFT.</p>
<p>To properly configure for GPU build the following needs to be used</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake -S $path_to_sources -B $path_to_build_directory -DBUILD_TARGET=gpu
</pre></div>
</div>
<p>Note, further configuration can be performed using <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>,
however the initial configuration of GPU builds must include the <code class="docutils literal notranslate"><span class="pre">-DBUILD_TARGET=gpu</span></code> flag as shown above.</p>
<p>By default CUDA aware MPI will be used together with <code class="docutils literal notranslate"><span class="pre">cudaFFT</span></code> for the FFT library. The configure will automatically look for the GPU architecture available on the system. If you are building on a HPC system please use a computing node for the installation. Useful variables to be added are</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_NCCL=yes</span></code> to activate the NCCL collectives</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_MANAGED=yes</span></code> to activate the automatic memory management form the NVHPC compiler</p></li>
</ul>
</div></blockquote>
<p>If you are getting the following error</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">The</span> <span class="n">CUDA</span> <span class="n">compiler</span> <span class="n">identification</span> <span class="ow">is</span> <span class="n">unknown</span>
   <span class="n">CMake</span> <span class="n">Error</span> <span class="n">at</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">Modules</span><span class="o">/</span><span class="n">CMakeDetermineCUDACompiler</span><span class="o">.</span><span class="n">cmake</span><span class="p">:</span><span class="mi">633</span> <span class="p">(</span><span class="n">message</span><span class="p">):</span>
   <span class="n">Failed</span> <span class="n">to</span> <span class="n">detect</span> <span class="n">a</span> <span class="n">default</span> <span class="n">CUDA</span> <span class="n">architecture</span>
</pre></div>
</div>
<p>It is possible that your default C compiler is too recent and not supported by <code class="docutils literal notranslate"><span class="pre">nvcc</span></code>.
You might be able to solve the issue by adding</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-DCMAKE_CUDA_HOST_COMPILER=$supported_gcc
</pre></div>
</div>
<p>At the moment the latest supported CUDA host compilers are <code class="docutils literal notranslate"><span class="pre">gcc11</span></code> and earlier.</p>
</div>
<div class="section" id="linking-from-external-codes">
<h2>Linking from external codes<a class="headerlink" href="#linking-from-external-codes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="codes-using-makefiles">
<h3>Codes using Makefiles<a class="headerlink" href="#codes-using-makefiles" title="Permalink to this headline">¶</a></h3>
<p>When building a code that links 2DECOMP&amp;FFT using a Makefile you will need to add the include and link paths as appropriate (<code class="docutils literal notranslate"><span class="pre">inlude/</span></code> and <code class="docutils literal notranslate"><span class="pre">lib/</span></code> under the installation directory, respectively).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DECOMP_ROOT = /path/to/2decomp-fft
DECOMP_BUILD_DIR = $(DECOMP_ROOT)/build
DECOMP_INSTALL_DIR ?= $(DECOMP_BUILD_DIR)/opt # Use default unless set by user

INC += -I$(DECOMP_INSTALL_DIR)/include

# Users build/link targets
LIBS = -L$(DECOMP_INSTALL_DIR)/lib64 -L$(DECOMP_INSTALL_DIR)/lib -ldecomp2d

OBJ = my_exec.o

my_exec: $(OBJ)
   $(F90) -o $@ $(OBJ) $(LIBS)
</pre></div>
</div>
<p>In case 2DECOMP&amp;FFT has been compiled with an external FFT, such as FFTW3, <code class="docutils literal notranslate"><span class="pre">LIBS</span></code> should also contain the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>FFTW3_PATH=/my_path_to_FFTW/lib
LIBFFT=-L$(FFTW3_PATH) -lfftw3 -lfftw3f
LIBS += $(LIBFFT)
</pre></div>
</div>
<p>In case of 2DECOMP&amp;FFT compiled for GPU with NVHPC, linking against cuFFT is mandatory</p>
<p><code class="docutils literal notranslate"><span class="pre">LIBS</span> <span class="pre">+=</span> <span class="pre">-cudalib=cufft</span></code></p>
<p>In case of NCCL the following is required</p>
<p><code class="docutils literal notranslate"><span class="pre">LIBS</span> <span class="pre">+=</span> <span class="pre">-cudalib=cufft,nccl</span></code></p>
<p>It is also possible to drive the build and installation of 2DECOMP&amp;FFT from a Makefile such as in the following example code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>FC = mpif90
BUILD = Release

DECOMP_ROOT = /path/to/2decomp-fft
DECOMP_BUILD_DIR = $(DECOMP_ROOT)/build
DECOMP_INSTALL_DIR ?= $(DECOMP_BUILD_DIR)/opt # Use default unless set by user

INC += -I$(DECOMP_INSTALL_DIR)/include

# Users build/link targets
LIBS = -L$(DECOMP_INSTALL_DIR)/lib64 -L$(DECOMP_INSTALL_DIR)/lib -ldecomp2d

# Building libdecomp.a
$(DECOMP_INSTALL_DIR)/lib/libdecomp.a:
FC=$(FC) cmake -S $(DECOMP_ROOT) -B $(DECOMP_BUILD_DIR) -DCMAKE_BUILD_TYPE=$(BUILD) -DCMAKE_INSTALL_PREFIX=$(DECOMP_INSTALL_DIR)
cmake --build $(DECOMP_BUILD_DIR) --target decomp2d
cmake --build $(DECOMP_BUILD_DIR) --target install

# Clean libdecomp.a
clean-decomp:
cmake --build $(DECOMP_BUILD_DIR) --target clean
rm -f $(DECOMP_INSTALL_DIR)/lib/libdecomp.a
</pre></div>
</div>
</div>
</div>
<div class="section" id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<p>Profiling can be activated via <code class="docutils literal notranslate"><span class="pre">cmake</span></code> configuration, however, the recommended approach is to run the initial configuration as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export caliper_DIR=/path/to/caliper/install/share/cmake/caliper
export FC=mpif90
export CXX=mpicxx
cmake -S $path_to_sources -B $path_to_build_directory -DENABLE_PROFILER=caliper
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">ENABLE_PROFILER</span></code> is set to the profiling tool desired, currently supported values are: <code class="docutils literal notranslate"><span class="pre">caliper</span></code>.
Note that when using <strong>caliper</strong> a C++ compiler is required as indicated in the above command line.</p>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list-of-preprocessor-variables">
<h3>List of preprocessor variables<a class="headerlink" href="#list-of-preprocessor-variables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> - This variable is automatically added in debug and dev builds. Extra information is printed when it is present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DOUBLE_PREC</span></code> - When this variable is not present, the library uses single precision. When it is present, the library uses double precision.
This preprocessor variable is driven by the <strong>CMake</strong> on/off variable <code class="docutils literal notranslate"><span class="pre">DOUBLE_PRECISION</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SAVE_SINGLE</span></code> - This variable is valid for double precision builds only. When it is present, snapshots are written in single precision.
This preprocessor variable is driven by the <strong>CMake</strong> on/off variable <code class="docutils literal notranslate"><span class="pre">SINGLE_PRECISION_OUTPUT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PROFILER</span></code> - This variable is automatically added when selecting the profiler. It activates the profiling sections of the code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EVEN</span></code> - This preprocessor variable is not valid for GPU builds. It leads to padded alltoall operations.
This preprocessor variable is driven by the <strong>CMake</strong> on/off variable <code class="docutils literal notranslate"><span class="pre">EVEN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code> - This variable leads to overwrite the input array when computing FFT. The support of this flag does not always correspond to in-place transforms,
depending on the FFT backend selected, as described above. This preprocessor variable is driven by the <strong>CMake</strong> on/off variable <code class="docutils literal notranslate"><span class="pre">ENABLE_INPLACE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HALO_DEBUG</span></code> - This variable is used to debug the halo operations. This preprocessor variable is driven by the <strong>CMake</strong> on/off variable <code class="docutils literal notranslate"><span class="pre">HALO_DEBUG</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GPU</span></code> - This variable is automatically added in GPU builds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_NCCL</span></code> - This variable is valid only for GPU builds. The NVIDIA Collective Communication Library (NCCL)
implements multi-GPU and multi-node communication primitives optimized for NVIDIA GPUs and Networking.</p></li>
</ul>
</div>
<div class="section" id="optional-dependencies">
<h3>Optional dependencies<a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">¶</a></h3>
<div class="section" id="fftw">
<h4>FFTW<a class="headerlink" href="#fftw" title="Permalink to this headline">¶</a></h4>
<p>The library <a class="reference external" href="http://www.fftw.org/index.html">FFTW</a> can be used as a backend for the FFT engine.
The version 3.3.10 was tested, is supported and can be downloaded
<a class="reference external" href="http://www.fftw.org/download.html">here [FFTW Download]</a>.
Please note that one should build fftw and decomp2d against the same compilers.
For build instructions, please check
<a class="reference external" href="http://www.fftw.org/fftw3_doc/Installation-on-Unix.html">the instructions</a>.
Below is a suggestion for the compilation of the library in double precision
(add <code class="docutils literal notranslate"><span class="pre">--enable-single</span></code> for a single precision build):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">fftw</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mf">10.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="n">xzf</span> <span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mf">10.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mkdir</span> <span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_tmp</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_tmp</span>
<span class="o">../</span><span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">10</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=</span><span class="n">xxxxxxx</span><span class="o">/</span><span class="n">fftw3</span><span class="o">/</span><span class="n">fftw</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_bld</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">shared</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="n">check</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Please note that the resulting build is not compatible with CMake
<a class="reference external" href="https://github.com/FFTW/fftw3/issues/130">see here</a>.
As a workaround, one can open the file <cite>/path/to/fftw3/install/lib/cmake/fftw3/FFTW3Config.cmake</cite> and comment the line</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="p">(</span><span class="s2">&quot;$</span><span class="si">{CMAKE_CURRENT_LIST_DIR}</span><span class="s2">/FFTW3LibraryDepends.cmake&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To build 2DECOMP&amp;FFT against fftw3, one can provide the package configuration for fftw3 in the <code class="docutils literal notranslate"><span class="pre">PKG_CONFIG_PATH</span></code> environment variable,
this should be found under <code class="docutils literal notranslate"><span class="pre">/path/to/fftw3/install/lib/pkgconfig</span></code>.
One can also provide the option <code class="docutils literal notranslate"><span class="pre">-DFFTW_ROOT=/path/to/fftw3/install</span></code>.
Then either specify on the command line when configuring the build</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">S</span> <span class="o">.</span> <span class="o">-</span><span class="n">B</span> <span class="n">build</span> <span class="o">-</span><span class="n">DFFT_Choice</span><span class="o">=&lt;</span><span class="n">fftw</span><span class="o">|</span><span class="n">fftw_f03</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">DFFTW_ROOT</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">fftw3</span><span class="o">/</span><span class="n">install</span>
</pre></div>
</div>
<p>or modify the build configuration using <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>.</p>
<p>Note the legacy <strong>fftw</strong> interface lacks interface definitions and will fail when stricter compilation flags are used
(e.g. when <code class="docutils literal notranslate"><span class="pre">-DCMAKE_BUILD_TYPE=Dev</span></code>) for this it is recommended to use <strong>fftw_f03</strong> which provides proper interfaces.</p>
</div>
<div class="section" id="caliper">
<h4>Caliper<a class="headerlink" href="#caliper" title="Permalink to this headline">¶</a></h4>
<p>The library <a class="reference external" href="https://github.com/LLNL/Caliper">caliper</a> can be used to profile the execution of the code.
The version 2.9.1 was tested and is supported,
version 2.8.0 has also been tested and is still expected to work.
Please note that one must build caliper and decomp2d against the same C/C++/Fortran compilers and MPI libray. For build instructions,
please check <a class="reference external" href="https://github.com/LLNL/Caliper#building-and-installing">the relative GitHub page</a>
and <a class="reference external" href="https://software.llnl.gov/Caliper/CaliperBasics.html#build-and-install">here</a>.
Below is a suggestion for the compilation of the library using the GNU compilers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/LLNL/Caliper.git caliper_github
cd caliper_github
git checkout v2.9.1
mkdir build &amp;&amp; cd build
cmake -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DCMAKE_Fortran_COMPILER=gfortran -DCMAKE_INSTALL_PREFIX=../../caliper_build_2.9.1 -DWITH_FORTRAN=yes -DWITH_MPI=yes -DBUILD_TESTING=yes ../
make -j
make test
make install``
</pre></div>
</div>
<p>After installing Caliper ensure to set <code class="docutils literal notranslate"><span class="pre">caliper_DIR=/path/to/caliper/install/share/cmake/caliper</span></code>.
Following this the 2DECOMP&amp;FFT build can be configured to use Caliper profiling as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">S</span> <span class="o">.</span> <span class="o">-</span><span class="n">B</span> <span class="o">-</span><span class="n">DENABLE_PROFILER</span><span class="o">=</span><span class="n">caliper</span>
</pre></div>
</div>
<p>or by modifying the configuration to set <code class="docutils literal notranslate"><span class="pre">ENABLE_PROFILER=caliper</span></code> via <code class="docutils literal notranslate"><span class="pre">ccmake</span></code>.</p>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">2decomp_doc</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-and-examples">Testing and examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gpu-compilation">GPU compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linking-from-external-codes">Linking from external codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#profiling">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="domaindecomposition.html">Domain Decomposition Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="fft.html">Fast Fourier Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to the documentation for the 2DECOMP&amp;FFT library!</a></li>
      <li>Next: <a href="domaindecomposition.html" title="next chapter">Domain Decomposition Strategies</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Sylvain.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pages/installation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>